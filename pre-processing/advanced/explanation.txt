# Explanation of Preprocessing V20

This document explains the data preprocessing pipeline implemented in `pre-processing-20.ipynb`.

## 1. Goal
The goal is to prepare the Anime and Rating datasets for data mining tasks (Classification, Clustering, Association Rule Mining) by cleaning the data, handling missing values, and transforming attributes into a suitable format.

## 2. Data Loading & Inspection (Before Processing)
We start by loading the raw `anime.csv` and `rating.csv`.
- **Anime Data**: Contains metadata like genre, type, episodes, rating, members.
- **Rating Data**: Contains user ratings for anime.
- **Visualizations**: We inspect the distribution of raw ratings, the proportion of valid vs -1 ratings, and the frequency of top genres.

## 3. Preprocessing Steps (V19 Logic)

### 3.1 Anime Data Cleaning
- **Missing Values**:
  - `genre`: Filled with 'Unknown'.
  - `type`: Filled with 'Unknown'.
  - `episodes`: 'Unknown' replaced with 0, converted to numeric.
  - `rating`: Filled with the median rating.
  - `members`: Filled with 0.
- **Genre Encoding**:
  - Used **TF-IDF** to vectorize the text genres.
  - Applied **KMeans Clustering (k=10)** to group similar genres into 10 clusters (`genre_encoded` 0-9).
- **Attribute Binning**:
  - `members`: Binned into 8 categories (0-7) based on popularity ranges.
  - `rating` (anime): Binned into 7 quality tiers (0-6).
  - `episodes`: Categorized into 'Movie/Special', 'Short_Series', etc.

### 3.2 Rating Data Cleaning
- **User Rating Encoding**:
  - The raw `rating` (-1 to 10) is binned into 6 categories (0-5).
  - **Crucial**: Rating `-1` is treated as a separate class `0` (No Rating), preserving this user behavior information.

### 3.3 Data Integration
- Merged `rating_cleaned` with `anime_cleaned` on `anime_id` (Left Join).
- Result: A combined dataset containing user ratings along with anime features (genre cluster, type, etc.).

## 4. After Analysis & Export
- **Visualizations**: We visualize the distribution of the encoded attributes (User Rating, Genre Clusters) to verify the transformation.
- **Export**:
  - **CSV**: `anime-cleaned.csv`, `rating-cleaned.csv`, `combined.csv` (Full data).
  - **ARFF**: `anime-cleaned.arff`, `rating-cleaned.arff`, `combined-cleaned.arff` (Sampled for Weka compatibility).

## 5. Key Decisions
- **KMeans for Genres**: Instead of high-dimensional multi-hot encoding, we used clustering to reduce genres to a single nominal attribute, which is more friendly for Weka algorithms like J48 and Naive Bayes.
- **Handling -1**: Kept as a specific class to allow models to learn from "watch but didn't rate" behavior.
